@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent CLS from font loading */
@layer base {
  html {
    /* Prevent layout shifts from scrollbar */
    scrollbar-gutter: stable;
  }

  /* ============================================
   * DALAT COLOR PALETTE - "Pine & Mist"
   * Inspired by Dalat's pine forests, morning mist,
   * coffee culture, and highland tranquility.
   *
   * Philosophy: Distinctive, calm, nature-forward.
   * Pine green primary makes this instantly recognizable.
   * ============================================ */

  :root {
    /* === LIGHT MODE: "Morning in the Pines" === */
    /* Soft mist, filtered forest light, quiet elegance */

    /* Core semantic colors */
    --background: 40 25% 98%;           /* warm off-white, hint of cream */
    --foreground: 160 15% 15%;          /* pine-tinted dark, not pure black */
    --card: 40 20% 97%;                 /* subtle warmth on cards */
    --card-foreground: 160 15% 15%;
    --popover: 40 20% 99%;
    --popover-foreground: 160 15% 15%;

    /* Primary: Pine Forest - calm, distinctive, grounded */
    --primary: 158 35% 32%;             /* deep pine green - the signature */
    --primary-foreground: 0 0% 100%;

    /* Secondary: Warm stone - earthy, supportive */
    --secondary: 35 20% 93%;            /* warm light stone */
    --secondary-foreground: 35 25% 30%;

    /* Muted: Morning mist - soft, receding */
    --muted: 160 10% 94%;               /* barely green-gray */
    --muted-foreground: 160 8% 45%;

    /* Accent: Soft sky blue - fresh highland air */
    --accent: 200 30% 94%;              /* very light sky */
    --accent-foreground: 200 40% 30%;

    /* Destructive: Muted warm red (not alarming) */
    --destructive: 0 60% 50%;
    --destructive-foreground: 0 0% 100%;

    /* UI elements */
    --border: 35 15% 88%;               /* warm gray border */
    --input: 35 15% 88%;
    --ring: 158 35% 32%;                /* pine green focus ring */

    /* Charts - nature palette */
    --chart-1: 158 35% 35%;             /* pine green */
    --chart-2: 35 65% 55%;              /* warm gold */
    --chart-3: 200 45% 50%;             /* sky blue */
    --chart-4: 25 55% 45%;              /* coffee brown */
    --chart-5: 280 25% 55%;             /* misty purple */

    /* === EXTENDED DALAT PALETTE === */
    /* For badges, highlights, special UI moments */
    --dalat-pine: 158 35% 32%;          /* same as primary */
    --dalat-pine-light: 158 25% 92%;    /* light pine wash */
    --dalat-gold: 38 75% 50%;           /* warm gold - for highlights */
    --dalat-gold-light: 40 60% 92%;     /* light gold wash */
    --dalat-coffee: 25 55% 35%;         /* rich coffee */
    --dalat-coffee-light: 30 40% 90%;   /* coffee cream */
    --dalat-hydrangea: 220 45% 55%;     /* hydrangea blue */
    --dalat-hydrangea-light: 220 35% 93%;
    --dalat-mist: 260 20% 65%;          /* misty purple */
    --dalat-mist-light: 260 15% 95%;

    --radius: 0.5rem;
  }

  .dark {
    /* === DARK MODE: "Evening Cafe" === */
    /* Warm lamp light, wood tables, steaming coffee */
    /* Not corporate blue-black, but cozy brown-black */

    /* Core semantic colors */
    --background: 30 20% 7%;            /* coffee-black, warm undertone */
    --foreground: 35 15% 90%;           /* warm cream text */
    --card: 30 18% 11%;                 /* elevated surface, still warm */
    --card-foreground: 35 15% 90%;
    --popover: 30 18% 9%;
    --popover-foreground: 35 15% 90%;

    /* Primary: Brighter pine for dark backgrounds */
    --primary: 158 40% 45%;             /* lighter pine, still recognizable */
    --primary-foreground: 160 30% 8%;   /* dark pine for contrast */

    /* Secondary: Warm dark stone */
    --secondary: 30 15% 18%;            /* dark warm stone */
    --secondary-foreground: 35 20% 85%;

    /* Muted: Deep forest shadow */
    --muted: 160 10% 15%;               /* dark pine-gray */
    --muted-foreground: 160 8% 55%;

    /* Accent: Deep sky */
    --accent: 200 25% 20%;              /* dark sky blue */
    --accent-foreground: 200 30% 85%;

    /* Destructive: Softened for dark */
    --destructive: 0 50% 45%;
    --destructive-foreground: 0 0% 95%;

    /* UI elements */
    --border: 30 12% 20%;               /* warm dark border */
    --input: 30 12% 20%;
    --ring: 158 40% 45%;                /* pine green focus */

    /* Charts - dark mode optimized */
    --chart-1: 158 40% 50%;             /* brighter pine */
    --chart-2: 38 70% 55%;              /* warm gold */
    --chart-3: 200 40% 55%;             /* sky blue */
    --chart-4: 25 50% 50%;              /* coffee */
    --chart-5: 280 25% 55%;             /* mist purple */

    /* === EXTENDED DALAT PALETTE (dark mode) === */
    --dalat-pine: 158 40% 45%;
    --dalat-pine-light: 158 20% 15%;    /* dark pine bg */
    --dalat-gold: 38 70% 55%;
    --dalat-gold-light: 38 40% 15%;     /* dark gold bg */
    --dalat-coffee: 25 50% 50%;
    --dalat-coffee-light: 25 30% 15%;
    --dalat-hydrangea: 220 40% 55%;
    --dalat-hydrangea-light: 220 25% 18%;
    --dalat-mist: 260 20% 55%;
    --dalat-mist-light: 260 15% 18%;
  }

  /* === MIDNIGHT: Pure OLED Black === */
  /* For OLED screens and those who prefer true black */
  .midnight {
    --background: 0 0% 0%;              /* pure black */
    --foreground: 0 0% 95%;             /* bright white text */
    --card: 0 0% 5%;                    /* barely lifted surface */
    --card-foreground: 0 0% 95%;
    --popover: 0 0% 3%;
    --popover-foreground: 0 0% 95%;

    --primary: 158 40% 50%;             /* brighter pine for contrast */
    --primary-foreground: 0 0% 0%;

    --secondary: 0 0% 12%;
    --secondary-foreground: 0 0% 90%;

    --muted: 0 0% 10%;
    --muted-foreground: 0 0% 55%;

    --accent: 200 30% 25%;
    --accent-foreground: 200 30% 90%;

    --destructive: 0 55% 50%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 15%;
    --input: 0 0% 15%;
    --ring: 158 40% 50%;

    --chart-1: 158 45% 55%;
    --chart-2: 38 75% 60%;
    --chart-3: 200 45% 60%;
    --chart-4: 25 55% 55%;
    --chart-5: 280 30% 60%;

    --dalat-pine: 158 45% 50%;
    --dalat-pine-light: 158 25% 10%;
    --dalat-gold: 38 75% 60%;
    --dalat-gold-light: 38 45% 10%;
    --dalat-coffee: 25 55% 55%;
    --dalat-coffee-light: 25 35% 10%;
    --dalat-hydrangea: 220 45% 60%;
    --dalat-hydrangea-light: 220 30% 12%;
    --dalat-mist: 260 25% 60%;
    --dalat-mist-light: 260 20% 12%;
  }

  /* === FOREST: Deep Pine Greens === */
  /* Nature-forward, immersed in Da Lat's pine forests */
  .forest {
    --background: 160 25% 6%;           /* deep forest floor */
    --foreground: 140 10% 92%;          /* soft green-white */
    --card: 160 22% 10%;                /* moss-covered elevation */
    --card-foreground: 140 10% 92%;
    --popover: 160 22% 8%;
    --popover-foreground: 140 10% 92%;

    --primary: 158 45% 48%;             /* vibrant pine */
    --primary-foreground: 160 30% 6%;

    --secondary: 160 18% 16%;           /* shadowed undergrowth */
    --secondary-foreground: 140 15% 88%;

    --muted: 160 15% 14%;               /* deep shadow */
    --muted-foreground: 160 10% 55%;

    --accent: 180 25% 22%;              /* teal forest pool */
    --accent-foreground: 180 25% 88%;

    --destructive: 0 50% 48%;
    --destructive-foreground: 0 0% 95%;

    --border: 160 15% 18%;              /* forest edge */
    --input: 160 15% 18%;
    --ring: 158 45% 48%;

    --chart-1: 158 45% 52%;
    --chart-2: 80 50% 50%;              /* leaf green */
    --chart-3: 180 40% 50%;             /* teal */
    --chart-4: 140 35% 45%;             /* sage */
    --chart-5: 200 35% 50%;             /* misty blue */

    --dalat-pine: 158 45% 48%;
    --dalat-pine-light: 160 25% 12%;
    --dalat-gold: 80 50% 55%;
    --dalat-gold-light: 80 35% 12%;
    --dalat-coffee: 140 35% 45%;
    --dalat-coffee-light: 140 25% 12%;
    --dalat-hydrangea: 200 40% 55%;
    --dalat-hydrangea-light: 200 25% 14%;
    --dalat-mist: 180 25% 55%;
    --dalat-mist-light: 180 18% 14%;
  }

  /* === HYDRANGEA: Purple Blooms === */
  /* Inspired by Da Lat's famous hydrangea flowers */
  .hydrangea {
    --background: 270 20% 7%;           /* deep purple-black */
    --foreground: 270 15% 92%;          /* soft lavender-white */
    --card: 270 18% 11%;                /* elevated purple surface */
    --card-foreground: 270 15% 92%;
    --popover: 270 18% 9%;
    --popover-foreground: 270 15% 92%;

    --primary: 270 45% 55%;             /* vibrant hydrangea purple */
    --primary-foreground: 270 30% 98%;

    --secondary: 270 15% 18%;
    --secondary-foreground: 270 20% 85%;

    --muted: 270 12% 15%;
    --muted-foreground: 270 10% 55%;

    --accent: 300 25% 25%;              /* magenta accent */
    --accent-foreground: 300 25% 90%;

    --destructive: 0 50% 48%;
    --destructive-foreground: 0 0% 95%;

    --border: 270 12% 20%;
    --input: 270 12% 20%;
    --ring: 270 45% 55%;

    --chart-1: 270 45% 55%;             /* hydrangea purple */
    --chart-2: 300 40% 55%;             /* magenta */
    --chart-3: 240 40% 55%;             /* blue-violet */
    --chart-4: 320 35% 50%;             /* rose */
    --chart-5: 200 35% 55%;             /* cool blue */

    --dalat-pine: 270 45% 55%;
    --dalat-pine-light: 270 25% 12%;
    --dalat-gold: 300 40% 55%;
    --dalat-gold-light: 300 30% 12%;
    --dalat-coffee: 270 30% 45%;
    --dalat-coffee-light: 270 20% 12%;
    --dalat-hydrangea: 270 50% 60%;
    --dalat-hydrangea-light: 270 30% 14%;
    --dalat-mist: 240 25% 55%;
    --dalat-mist-light: 240 18% 14%;
  }

  /* === GOLDEN: Sunset Over the Highlands === */
  /* Warm amber glow of Da Lat golden hour */
  .golden {
    --background: 30 30% 6%;            /* deep amber-black */
    --foreground: 40 20% 92%;           /* warm cream */
    --card: 30 25% 10%;                 /* warm elevated surface */
    --card-foreground: 40 20% 92%;
    --popover: 30 25% 8%;
    --popover-foreground: 40 20% 92%;

    --primary: 38 80% 50%;              /* golden amber */
    --primary-foreground: 30 40% 8%;

    --secondary: 30 20% 16%;
    --secondary-foreground: 40 25% 85%;

    --muted: 30 15% 14%;
    --muted-foreground: 35 12% 55%;

    --accent: 20 50% 30%;               /* burnt orange accent */
    --accent-foreground: 20 30% 90%;

    --destructive: 0 55% 50%;
    --destructive-foreground: 0 0% 95%;

    --border: 30 18% 18%;
    --input: 30 18% 18%;
    --ring: 38 80% 50%;

    --chart-1: 38 80% 55%;              /* gold */
    --chart-2: 25 70% 50%;              /* orange */
    --chart-3: 45 65% 55%;              /* yellow */
    --chart-4: 15 60% 45%;              /* burnt sienna */
    --chart-5: 55 50% 50%;              /* olive gold */

    --dalat-pine: 38 80% 50%;
    --dalat-pine-light: 38 40% 12%;
    --dalat-gold: 38 85% 55%;
    --dalat-gold-light: 38 50% 12%;
    --dalat-coffee: 25 60% 45%;
    --dalat-coffee-light: 25 35% 12%;
    --dalat-hydrangea: 45 50% 55%;
    --dalat-hydrangea-light: 45 30% 14%;
    --dalat-mist: 30 30% 55%;
    --dalat-mist-light: 30 20% 14%;
  }

  /* === COFFEE: Rich Highland Brew === */
  /* Da Lat's famous coffee culture, rich and warm */
  .coffee {
    --background: 25 25% 6%;            /* deep coffee brown */
    --foreground: 30 15% 90%;           /* cream text */
    --card: 25 22% 10%;                 /* mocha surface */
    --card-foreground: 30 15% 90%;
    --popover: 25 22% 8%;
    --popover-foreground: 30 15% 90%;

    --primary: 25 60% 45%;              /* rich coffee brown */
    --primary-foreground: 30 30% 95%;

    --secondary: 25 18% 16%;
    --secondary-foreground: 30 20% 85%;

    --muted: 25 15% 14%;
    --muted-foreground: 25 10% 55%;

    --accent: 35 40% 28%;               /* caramel accent */
    --accent-foreground: 35 25% 90%;

    --destructive: 0 50% 48%;
    --destructive-foreground: 0 0% 95%;

    --border: 25 15% 18%;
    --input: 25 15% 18%;
    --ring: 25 60% 45%;

    --chart-1: 25 60% 50%;              /* coffee */
    --chart-2: 35 55% 50%;              /* caramel */
    --chart-3: 15 50% 45%;              /* espresso */
    --chart-4: 40 45% 55%;              /* latte */
    --chart-5: 20 40% 40%;              /* dark roast */

    --dalat-pine: 25 60% 45%;
    --dalat-pine-light: 25 30% 12%;
    --dalat-gold: 35 55% 55%;
    --dalat-gold-light: 35 35% 12%;
    --dalat-coffee: 25 65% 50%;
    --dalat-coffee-light: 25 40% 12%;
    --dalat-hydrangea: 15 45% 50%;
    --dalat-hydrangea-light: 15 28% 14%;
    --dalat-mist: 30 25% 50%;
    --dalat-mist-light: 30 18% 14%;
  }

  /* === MISTY: Cool Highland Morning === */
  /* The soft blue-gray of Da Lat's misty mornings */
  .misty {
    --background: 210 15% 8%;           /* cool blue-gray */
    --foreground: 210 10% 92%;          /* soft blue-white */
    --card: 210 14% 12%;                /* misty surface */
    --card-foreground: 210 10% 92%;
    --popover: 210 14% 10%;
    --popover-foreground: 210 10% 92%;

    --primary: 200 50% 50%;             /* highland sky blue */
    --primary-foreground: 200 30% 98%;

    --secondary: 210 12% 18%;
    --secondary-foreground: 210 15% 85%;

    --muted: 210 10% 15%;
    --muted-foreground: 210 8% 55%;

    --accent: 220 30% 28%;              /* deeper blue accent */
    --accent-foreground: 220 25% 90%;

    --destructive: 0 50% 48%;
    --destructive-foreground: 0 0% 95%;

    --border: 210 10% 20%;
    --input: 210 10% 20%;
    --ring: 200 50% 50%;

    --chart-1: 200 50% 55%;             /* sky blue */
    --chart-2: 220 45% 55%;             /* steel blue */
    --chart-3: 190 40% 50%;             /* teal */
    --chart-4: 230 35% 50%;             /* slate blue */
    --chart-5: 180 30% 50%;             /* cyan */

    --dalat-pine: 200 50% 50%;
    --dalat-pine-light: 200 30% 12%;
    --dalat-gold: 220 45% 55%;
    --dalat-gold-light: 220 30% 12%;
    --dalat-coffee: 210 35% 45%;
    --dalat-coffee-light: 210 25% 12%;
    --dalat-hydrangea: 230 40% 55%;
    --dalat-hydrangea-light: 230 25% 14%;
    --dalat-mist: 200 35% 55%;
    --dalat-mist-light: 200 22% 14%;
  }

  /* === ROSE: Valley of Love === */
  /* Soft pink tones from Da Lat's flower gardens */
  .rose {
    --background: 350 15% 7%;           /* deep rose-black */
    --foreground: 350 12% 92%;          /* soft pink-white */
    --card: 350 14% 11%;                /* rose surface */
    --card-foreground: 350 12% 92%;
    --popover: 350 14% 9%;
    --popover-foreground: 350 12% 92%;

    --primary: 350 55% 55%;             /* rose pink */
    --primary-foreground: 350 30% 98%;

    --secondary: 350 12% 17%;
    --secondary-foreground: 350 18% 85%;

    --muted: 350 10% 14%;
    --muted-foreground: 350 8% 55%;

    --accent: 330 35% 30%;              /* deeper magenta accent */
    --accent-foreground: 330 25% 90%;

    --destructive: 0 55% 50%;
    --destructive-foreground: 0 0% 95%;

    --border: 350 10% 19%;
    --input: 350 10% 19%;
    --ring: 350 55% 55%;

    --chart-1: 350 55% 58%;             /* rose */
    --chart-2: 330 50% 55%;             /* magenta */
    --chart-3: 10 50% 55%;              /* coral */
    --chart-4: 320 40% 50%;             /* orchid */
    --chart-5: 0 45% 55%;               /* red-pink */

    --dalat-pine: 350 55% 55%;
    --dalat-pine-light: 350 30% 12%;
    --dalat-gold: 330 50% 55%;
    --dalat-gold-light: 330 32% 12%;
    --dalat-coffee: 350 35% 45%;
    --dalat-coffee-light: 350 22% 12%;
    --dalat-hydrangea: 320 45% 55%;
    --dalat-hydrangea-light: 320 28% 14%;
    --dalat-mist: 340 30% 55%;
    --dalat-mist-light: 340 20% 14%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* ============================================
 * THEME TRANSITION SYSTEM
 * Smooth 300ms transitions when switching themes
 * ============================================ */

html:not(.no-transitions) *,
html:not(.no-transitions) *::before,
html:not(.no-transitions) *::after {
  transition-property: color, background-color, border-color, box-shadow, fill, stroke;
  transition-duration: 300ms;
  transition-timing-function: ease-out;
}

/* Exclude elements that shouldn't transition (prevents image/video flash) */
html:not(.no-transitions) img,
html:not(.no-transitions) video,
html:not(.no-transitions) canvas,
html:not(.no-transitions) [data-no-theme-transition] {
  transition: none !important;
}

/* ============================================
 * HERO VISUAL EFFECTS
 * Film grain, light leak for organic Dalat vibes
 * ============================================ */

/* Subtle film grain texture for organic feel */
.hero-grain::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity: 0.03;
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* Light leak effect - soft morning light filtering through pines */
.hero-light-leak::before {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  width: 40%;
  height: 60%;
  background: radial-gradient(
    ellipse at 100% 0%,
    hsl(158 35% 50% / 0.08),
    transparent 70%
  );
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .animate-hero-breathe {
    animation: none !important;
  }
  .animate-hero-fade-up {
    animation: none !important;
    opacity: 1 !important;
  }
}

/* Novu inbox mobile scroll lock - prevents background from moving when swiping in inbox */
[class*="nv-inbox__popover"],
[class*="nv-popover"],
[class*="nv-root"] [role="dialog"] {
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y pinch-zoom;
}

/* Lock body scroll when Novu popover is open */
body:has([class*="nv-popover"][data-state="open"]),
body:has([class*="nv-inbox__popover"][data-state="open"]),
body:has([class*="nv-root"] [role="dialog"][data-state="open"]) {
  overflow: hidden;
  overscroll-behavior: none;
}

/* Ensure Novu notification list doesn't propagate scroll */
[class*="nv-notificationList"],
[class*="nv-notification-list"],
[class*="nv-inbox"] [role="listbox"],
[class*="nv-inbox"] [role="list"] {
  overscroll-behavior: contain;
  touch-action: pan-y;
}

/* Scrollbar hide utility for immersive scroll-snap */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Performance: Prevent layout shifts from images */
img {
  content-visibility: auto;
}

/* Reduce animation jank with GPU acceleration for common transitions */
.transition-transform,
.transition-all,
.animate-pulse,
.animate-spin {
  will-change: transform;
}

/* Optimize font rendering */
body {
  text-rendering: optimizeSpeed;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Reduce paint areas for fixed elements */
.fixed {
  contain: layout style;
}

/* Content visibility optimization for below-fold content */
@media (min-width: 1024px) {
  footer {
    content-visibility: auto;
    contain-intrinsic-size: auto 200px;
  }
}

/* Map marker pulsing animation for "happening now" events */
@keyframes pulse-ring {
  0% {
    transform: scale(0.95);
    opacity: 1;
  }
  70%, 100% {
    transform: scale(1.3);
    opacity: 0;
  }
}

/* Celebration modal - nuclear option centering that overrides everything */
.celebration-center {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: 9999 !important;
}

/* ============================================
 * AUDIO PLAYER RANGE INPUT STYLING
 * Cross-browser custom slider for mini-player
 * ============================================ */

/* Base styling for audio seekbar */
input[type="range"].audio-seekbar {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
  width: 100%;
}

/* Track styling - Webkit (Chrome, Safari, Edge) */
input[type="range"].audio-seekbar::-webkit-slider-runnable-track {
  height: 4px;
  border-radius: 9999px;
  background: hsl(var(--muted));
}

/* Thumb styling - Webkit */
input[type="range"].audio-seekbar::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: hsl(var(--primary));
  margin-top: -4px; /* Center on track */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  transition: transform 0.1s ease;
}

input[type="range"].audio-seekbar::-webkit-slider-thumb:hover {
  transform: scale(1.2);
}

input[type="range"].audio-seekbar::-webkit-slider-thumb:active {
  transform: scale(1.1);
}

/* Track styling - Firefox */
input[type="range"].audio-seekbar::-moz-range-track {
  height: 4px;
  border-radius: 9999px;
  background: hsl(var(--muted));
}

/* Thumb styling - Firefox */
input[type="range"].audio-seekbar::-moz-range-thumb {
  width: 12px;
  height: 12px;
  border: none;
  border-radius: 50%;
  background: hsl(var(--primary));
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  transition: transform 0.1s ease;
}

input[type="range"].audio-seekbar::-moz-range-thumb:hover {
  transform: scale(1.2);
}

/* Progress fill for Firefox */
input[type="range"].audio-seekbar::-moz-range-progress {
  height: 4px;
  border-radius: 9999px;
  background: hsl(var(--primary));
}
